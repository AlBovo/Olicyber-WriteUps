#!/usr/bin/env python3
from hashlib import sha256
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad

g = 87487451594556866508030094468499027367517449773212152531065848342617265911777308378905266549123762316205042209304468416187329853362415068716391365660947628684331879256102052866617901782762934681366493433309523100579576919948815226140753873376664982987731263198873316150137206066052549114642659983503044681959
a = 180777236963081956134404245244937550328891830334665940441551994277612051736516126928541219978793987937420498381033395520513312133659367793603807737620998537765090343244260501800471445243607244736928046711268154025147246544837965742113268752042348070738730118508357359724186069250741858024160508366666001182060 - g
b = 253937990137426458543090022045452724061925057172201110635482993250605976253657412840884177612067012100940221138735331012598749296657274666017490007488541395347252641780790107279448673462940813103377352752040996654662142270376165772313235472842010223880868339942687435936444931818882357958621075753066604884541 - g
flag = bytes.fromhex("e68d1dcaff452b2361774d785abcedab5cf2b9ea9155c18cac7213de069a91ef95bb44da94f60aa15da88bd5fbe121feef9e38eceffabc889bcb1a1611eec908")

shared_key = sha256(str(g + a + b).encode()).digest()[:16]
c = AES.new(shared_key, AES.MODE_ECB)
print(f"Decrypted flag: {c.decrypt(pad(flag,16))}")
